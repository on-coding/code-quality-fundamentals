
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../..">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>DRY - Code Quality Fundamentals Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#what-is-dry" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Code Quality Fundamentals Guide" class="md-header__button md-logo" aria-label="Code Quality Fundamentals Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Code Quality Fundamentals Guide
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DRY
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Code Quality Fundamentals Guide" class="md-nav__button md-logo" aria-label="Code Quality Fundamentals Guide" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Code Quality Fundamentals Guide
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          DRY
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        DRY
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-dry" class="md-nav__link">
    What is DRY
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problems" class="md-nav__link">
    Problems
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-duplication" class="md-nav__link">
    What is duplication
  </a>
  
    <nav class="md-nav" aria-label="What is duplication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1" class="md-nav__link">
    Example 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2" class="md-nav__link">
    Example 2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tradeoffs" class="md-nav__link">
    Tradeoffs
  </a>
  
    <nav class="md-nav" aria-label="Tradeoffs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generalization-complexity" class="md-nav__link">
    Generalization complexity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#over-generalization" class="md-nav__link">
    Over-generalization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difficulty-of-updating-shared-functionality" class="md-nav__link">
    Difficulty of updating shared functionality
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-examples" class="md-nav__link">
    Code Examples
  </a>
  
    <nav class="md-nav" aria-label="Code Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#repeated-lines-of-code" class="md-nav__link">
    Repeated lines of code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repeated-constants" class="md-nav__link">
    Repeated constants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicated-storage-format-dependency" class="md-nav__link">
    Duplicated storage format dependency
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-dry" class="md-nav__link">
    What is DRY
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problems" class="md-nav__link">
    Problems
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-duplication" class="md-nav__link">
    What is duplication
  </a>
  
    <nav class="md-nav" aria-label="What is duplication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-1" class="md-nav__link">
    Example 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2" class="md-nav__link">
    Example 2
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tradeoffs" class="md-nav__link">
    Tradeoffs
  </a>
  
    <nav class="md-nav" aria-label="Tradeoffs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generalization-complexity" class="md-nav__link">
    Generalization complexity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#over-generalization" class="md-nav__link">
    Over-generalization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difficulty-of-updating-shared-functionality" class="md-nav__link">
    Difficulty of updating shared functionality
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-examples" class="md-nav__link">
    Code Examples
  </a>
  
    <nav class="md-nav" aria-label="Code Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#repeated-lines-of-code" class="md-nav__link">
    Repeated lines of code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repeated-constants" class="md-nav__link">
    Repeated constants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicated-storage-format-dependency" class="md-nav__link">
    Duplicated storage format dependency
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>DRY</h1>

<h2 id="what-is-dry">What is DRY</h2>
<p>DRY stands for "Don't Repeat Yourself". It's a principle that roughly says that we should avoid duplication.</p>
<p>Most developers intuitively understand that repeating the same block of code multiple times in our code base is a bad idea, but what exactly is the problem?</p>
<h2 id="problems">Problems</h2>
<ul>
<li><strong>Bugs and Inconsistencies</strong></li>
</ul>
<p>There's a risk that someone will accidentally change the logic in one place but forget to update the same logic elsewhere</p>
<ul>
<li><strong>Making changes will take longer</strong></li>
</ul>
<p>It will take a bit longer to type out changes because we have to make them in multiple places. However that's a small issue compared to how much longer
  it will take us to reason about what changes to make in the first place. We're likely to spend time:</p>
<ul>
<li>tracking down all the places where the logic is used</li>
<li>understanding the current implementation for each one, since they may be slightly different</li>
<li>figuring out the right change in each case</li>
</ul>
<h2 id="what-is-duplication">What is duplication</h2>
<p>We can see that these problems apply more widely than just when lines of code are repeated. As a simple example, we could implement that exact same functionality twice but without any lines of code in common. But we can still hit the problems above even if each piece of functionality is only implemented once.</p>
<p>The more general principle is</p>
<div class="admonition note">
<p>We should avoid depending on the same choice in multiple different places</p>
</div>
<p>Here "choice" means any decision about the functionality our software supports or how that functionality is implemented. These choices don't have to have been made by us, for instance they could come from a product team or an upstream system.</p>
<p>If we did have code that depends on particular choice scattered throughout our system, then if that choice were to change we would hit the same problems described above.</p>
<p>To give a couple of examples:</p>
<h4 id="example-1">Example 1</h4>
<ul>
<li>We need to be able to quickly find items in a list of names, so we <strong>choose</strong> to keep the list sorted.</li>
<li>In one part of the codebase we have a function that inserts items into the list, ensuring the list remains sorted.</li>
<li>In another part of the codebase we have a function the finds an item in the list, assuming that the list is already sorted.</li>
</ul>
<h4 id="example-2">Example 2</h4>
<ul>
<li>We need to store data about a customers order. We <strong>choose</strong> to store it in a csv file with the column order being (item, price, quantity)</li>
<li>In one part of the codebase we write the csv file with column order (item, price, quantity)</li>
<li>In another part of the codebase we read the csv file, assuming the column order is (item, price, quantity)</li>
</ul>
<p>In both examples there is no duplication of the functionality, but there are multiple places where the logic relies on the same underlying choice about how the data is structured.</p>
<p>In both cases the solution is to move the two functions next to each other in the code base. Although there is still some duplication, the associated problems are greatly reduced because they are contained to a single file rather than the whole codebase.</p>
<p>Often we won't be able to completely remove duplication but we can still manage it by limiting it to a specific part of the codebase. This idea ties into other principles such as "Encapsulation" and "Separation of Concerns", which will be covered in other articles.</p>
<h2 id="tradeoffs">Tradeoffs</h2>
<h3 id="generalization-complexity">Generalization complexity</h3>
<p>Sometimes each use case of the same logic is different enough that extracting the shared part is quite difficult. It might create more complexity to implement the general case rather than having a different implementation for each case.</p>
<h3 id="over-generalization">Over-generalization</h3>
<p>Sometimes code is only "coincidentally" that same rather than logically representing the same thing. For example you may have two types, one that represents the user input for an order, and one that represents an order as it is stored in the database. They might currently have all the same fields, however logically they represent different things and will likely deviate overtime.</p>
<h3 id="difficulty-of-updating-shared-functionality">Difficulty of updating shared functionality</h3>
<p>If multiple functions call the same function, and then any changes to that API for that shared function will require updating all of the callers. This might be reasonable if the code is all in a single repository, however if the function is part of a shared library then this will be more difficult.</p>
<h2 id="code-examples">Code Examples</h2>
<h3 id="repeated-lines-of-code">Repeated lines of code</h3>
<p>This is a simple case where two functions implement very similar logic. The solution is to pull out the common part of the logic into a shared function.</p>
<div class="highlight"><span class="filename">With duplication</span><pre><span></span><code><span class="k">def</span> <span class="nf">total_book_value</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">]):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span>
        <span class="n">order</span><span class="o">.</span><span class="n">price</span> <span class="o">*</span> <span class="n">order</span><span class="o">.</span><span class="n">quantity</span>
        <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">orders</span>
        <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;book&quot;</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">total_grocery_value</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">]):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span>
        <span class="n">order</span><span class="o">.</span><span class="n">price</span> <span class="o">*</span> <span class="n">order</span><span class="o">.</span><span class="n">quantity</span>
        <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">orders</span>
        <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;grocery&quot;</span>
    <span class="p">)</span>
</code></pre></div>
<div class="highlight"><span class="filename">Fixed</span><pre><span></span><code><span class="k">def</span> <span class="nf">total_value_by_category</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">],</span> <span class="n">category</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span>
        <span class="n">order</span><span class="o">.</span><span class="n">price</span> <span class="o">*</span> <span class="n">order</span><span class="o">.</span><span class="n">quantity</span>
        <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">orders</span>
        <span class="k">if</span> <span class="n">order</span><span class="o">.</span><span class="n">category</span> <span class="o">==</span> <span class="n">category</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">total_book_value</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">total_value_by_category</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="s2">&quot;book&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">total_grocery_value</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">total_value_by_category</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="s2">&quot;grocery&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="repeated-constants">Repeated constants</h3>
<p>The problem here is that two different functions assume <code>book</code> is spelt in a certain way, i.e. <code>book</code> rather than <code>Book</code>. In general these constants are called "Magic strings" and they can be replaced by named constants. In this case there are multiple categories so we could also use an enum.</p>
<div class="highlight"><span class="filename">With duplication</span><pre><span></span><code><span class="k">def</span> <span class="nf">total_book_value</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">total_value_by_category</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="s2">&quot;book&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_book_order</span><span class="p">(</span><span class="n">price</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">quantity</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Order</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Order</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">quantity</span><span class="p">,</span> <span class="s2">&quot;book&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><span class="filename">Fixed</span><pre><span></span><code><span class="k">class</span> <span class="nc">Category</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">BOOK</span> <span class="o">=</span> <span class="s2">&quot;book&quot;</span>
    <span class="n">GROCERY</span> <span class="o">=</span> <span class="s2">&quot;grocery&quot;</span>


<span class="k">def</span> <span class="nf">total_book_value</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">total_value_by_category</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="n">Category</span><span class="o">.</span><span class="n">BOOK</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_book_order</span><span class="p">(</span><span class="n">price</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">quantity</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Order</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Order</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">quantity</span><span class="p">,</span> <span class="n">Category</span><span class="o">.</span><span class="n">BOOK</span><span class="p">)</span>
</code></pre></div>
<h3 id="duplicated-storage-format-dependency">Duplicated storage format dependency</h3>
<p>With duplication:</p>
<div class="highlight"><span class="filename">save_orders.py</span><pre><span></span><code><span class="k">def</span> <span class="nf">save_orders</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;orders.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">orders</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">((</span><span class="n">order</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">price</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">quantity</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><span class="filename">total_value.py</span><pre><span></span><code><span class="k">def</span> <span class="nf">total_value</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;orders.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="n">item</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">quantity</span> <span class="o">=</span> <span class="n">row</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">price</span> <span class="o">*</span> <span class="n">quantity</span>
    <span class="k">return</span> <span class="n">total</span>
</code></pre></div>
<p>Fixed:</p>
<div class="highlight"><span class="filename">order_storage.py</span><pre><span></span><code><span class="n">ORDER_FILENAME</span> <span class="o">=</span> <span class="s2">&quot;order.csv&quot;</span>

<span class="k">def</span> <span class="nf">save_orders</span><span class="p">(</span><span class="n">orders</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ORDER_FILENAME</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">orders</span><span class="p">:</span>
            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">((</span><span class="n">order</span><span class="o">.</span><span class="n">item</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">price</span><span class="p">,</span> <span class="n">order</span><span class="o">.</span><span class="n">quantity</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">read_order</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">]:</span>
    <span class="n">results</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Order</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ORDER_FILENAME</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="n">item</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">quantity</span> <span class="o">=</span> <span class="n">row</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Order</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">quantity</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">results</span>
</code></pre></div>
<div class="highlight"><span class="filename">total_value.py</span><pre><span></span><code><span class="k">def</span> <span class="nf">total_value</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
    <span class="n">orders</span> <span class="o">=</span> <span class="n">read_orders</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">order</span><span class="o">.</span><span class="n">price</span> <span class="o">*</span> <span class="n">order</span><span class="o">.</span><span class="n">quantity</span> <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">orders</span><span class="p">)</span>
</code></pre></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>